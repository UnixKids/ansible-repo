---
- hosts: cloud_node
  become: true
  tasks:
    
    - name: Create ansible user
      user:
        name: ansible
        shell: /bin/bash
        generate_ssh_key: yes
        ssh_key_file: .ssh/id_rsa

    - name: Copying ssh-keys to Ansible user
      copy:
        src: ansible_authorized_keys
        dest: /home/ansible/.ssh/authorized_keys
        owner: ansible
        group: ansible
        mode: 0600

    - name: Create jwilliams user
      user:
        name: jwilliams
        shell: /bin/bash/
        generate_ssh_key: yes
        ssh_key_file: .ssh/id_rsa

    - name: Copy ssh-keys to jwilliams user
      copy:
        src: jwilliams_authorized_keys
        dest: /home/jwilliams/.ssh/authorized_keys
        owner: jwilliams
        group: jwilliams
        mode: 0600

    - name: Copying /etc/sudoers
      copy:
        src: sudoers
        dest: /etc/sudoers
        owner: root
        group: root
        mode: 0440
